<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>accelerometer Test</title>

<body>
    <p>
        Coordinates:
        (<span id="beta" class="value">null</span>,
        <span id="gamma" class="value">null</span>,
        <span id="alpha" class="value">null</span>)
    </p>
    <canvas id="myCanvas" width="500" height="500" style="border:1px solid #d3d3d3;">>
        Your browser does not support the canvas element.
    </canvas>
    <script>
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");

        const ARRAY_MAX = 30;
        const MAX_OPACITY = 60;

        var circleArray = []
        var arrayIndex = 0;

        for (i = 0; i < ARRAY_MAX; i++) {
            circleArray.push({ xPos: 0, yPos: 0, radius: 0, opacity: 0 });
        }

        if (!('ondeviceorientation' in window)) {
            //document.getElementById('do-unsupported').classList.remove('hidden');
        } else {
            //document.getElementById('do-info').classList.remove('hidden');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            window.addEventListener('deviceorientation', function (event) {
                document.getElementById('beta').innerHTML = Math.round(event.beta);
                document.getElementById('gamma').innerHTML = Math.round(event.gamma);
                document.getElementById('alpha').innerHTML = Math.round(event.alpha);
                //document.getElementById('is-absolute').innerHTML = event.absolute ? "true" : "false";



                var width = canvas.width;
                var height = canvas.height;

                var centerX = width / 2;
                var centerY = height / 2;

                var xMax = centerX;
                var yMax = centerY;
                var rMax = width / 5;

                var x = centerX + (event.gamma / 90 * xMax);
                var y = centerY + (event.beta / 90 * yMax);
                var r = Math.abs(180 - event.alpha) / 180 * rMax;

                ctx.clearRect(0, 0, width, height);

                circleArray[arrayIndex].xPos = x;
                circleArray[arrayIndex].yPos = y;
                circleArray[arrayIndex].radius = r;
                circleArray[arrayIndex].opacity = MAX_OPACITY;

                var i;
                for (i = 0; i < circleArray.length; i++) {
                    if (i == arrayIndex)
                        continue;

                    circleArray[i].opacity /= 2;
                    var alpha = circleArray[i].opacity / 100;
                    ctx.beginPath();
                    ctx.arc(circleArray[i].xPos, circleArray[i].yPos, circleArray[i].radius, 0, 2 * Math.PI);
                    ctx.fillStyle = `rgba(255, 127, 39, ${alpha})`;
                    ctx.fill();
                }

                ctx.beginPath();
                ctx.arc(circleArray[arrayIndex].xPos, circleArray[arrayIndex].yPos, circleArray[arrayIndex].radius, 0, 2 * Math.PI);
                ctx.fillStyle = `rgba(255, 127, 39, 1)`;
                ctx.fill();

                arrayIndex++
                if (arrayIndex >= ARRAY_MAX)
                    arrayIndex = 0;
            });


        }
    </script>
</body>

</html>